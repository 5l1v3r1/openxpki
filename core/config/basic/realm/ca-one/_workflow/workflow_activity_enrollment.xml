<!-- 
  Generated by: tools/scripts/ogflow.pl 

     File: core/config/graffle/workflow_enrollment.graffle
  Version: 2.3
      Git: ec222ee12c92b17c46e38df23278a6400e5c96bc (modified)
-->


<actions>

    <action name="enroll_initialize"
            class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
            source="SCEP">
            <field name="_pkcs7" is_required="yes"/>
            <field name="_url_params"/>
            <field name="cert_profile"/>
            <field name="f_valid_csr"/>
            <field name="f_valid_scep_tid"/>
            <field name="pkcs10" is_required="yes"/>
            <field name="scep_tid" is_required="yes"/>
            <field name="server"/>
            <field name="signer_cert" is_required="yes"/>
            <field name="t_signer_cert_crypt_ok"/>
            <field name="t_signer_validity_ok"/>
    </action>

    <action name="enroll_disapprove"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_deny_authentication"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_issue_cert"
            class="OpenXPKI::Server::Workflow::Activity::NICE::IssueCertificate">
    </action>

    <action name="enroll_revoke_existing_certs"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::RevokeExistingCerts">
    </action>


    <action name="enroll_add_authentication"
            class="OpenXPKI::Server::Workflow::Activity::Tools::SetContext"
            num_manual_authen="1">
    </action>

    <action name="enroll_invalidate_challenge_pass"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_persist_csr"
            class="OpenXPKI::Server::Workflow::Activity::CSR::PersistRequest">
    </action>

    <action name="enroll_modify_metadata"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_fetch_group_policy"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::FetchGroupPolicy">
    </action>

    <action name="enroll_clear_approvals"
            class="OpenXPKI::Server::Workflow::Activity::Tools::CancelApprovals">
    </action>

    <action name="enroll_continue_issuance"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_extract_csr"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::ExtractCSR">
    </action>

    <action name="enroll_fork_publish"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_get_cert_profile"
            class="Workflow::Action::Null">
    </action>

    <action name="enroll_calc_approvals"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::CalcApprovals">
            <field name="approval_points"/>
    </action>

    <action name="enroll_serialize_unique_id"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::SerializeUniqueId">
    </action>

    <action name="enroll_eval_challenge"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::EvaluateChallenge">
    </action>

    <action name="enroll_load_recent_certificate"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::LoadRecentCertificate">
    </action>

    <action name="enroll_eval_eligibility"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::EvaluateEligibility">
    </action>

    <action name="enroll_eval_signer_trust"
            class="OpenXPKI::Server::Workflow::Activity::SCEPv2::EvaluateSignerTrust">
    </action>

    <action name="enroll_next_cert_to_revoke"
            class="OpenXPKI::Server::Workflow::Activity::Tools::WFArray"
            array_name="tmp_queue"
            context_key="cert_identifier"
            function="shift">
            <field name="tmp_queue" is_required="yes"/>
    </action>

    <action name="enroll_revoke_cert"
            class="OpenXPKI::Server::Workflow::Activity::Tools::RevokeCertificate"
            auto_approval="1"
            reason_code="superseded">
            <field name="cert_identifier" is_required="yes"/>
    </action>

    <action name="enroll_null1" class="Workflow::Action::Null"/>
    <action name="enroll_null2" class="Workflow::Action::Null"/>
    <action name="enroll_null3" class="Workflow::Action::Null"/>
</actions>
