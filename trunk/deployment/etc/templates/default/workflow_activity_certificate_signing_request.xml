<actions>
  <!-- this action name has not to be human readable      -->
  <!-- because it is only used to initialize the workflow -->
  <action name="create_csr"
	  class="Workflow::Action::Null">
      <condition name="ACL::create_csr"/>
      <!-- do not use field with is_required                -->
      <!-- because this ignores the order of the validators -->
      <validator name="HasRequiredField">
        <arg>cert_role</arg>
      </validator>
      <validator name="CertProfile">
        <arg>$cert_role</arg>
        <arg>$cert_profile</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_subject_style</arg>
        <arg>cert_subject</arg>
      </validator>
      <validator name="CertSubject">
        <arg>$cert_profile</arg>
        <arg>$cert_subject_style</arg>
        <arg>$cert_subject</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_subject_alt_name</arg>
      </validator>
      <validator name="CertSubjectAltName">
        <arg>$cert_subject_alt_name</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_info</arg>
        <arg>csr_type</arg>
      </validator>
      <validator name="SPKAC">
        <arg>$csr_type</arg>
        <arg>$spkac</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_SUBJECT"
	  class="Workflow::Action::Null">
      <condition name="ACL::change_csr_subject"/>
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_subject"/>
      <validator name="CertSubject">
        <arg>$cert_profile</arg>
        <arg>$cert_subject_style</arg>
        <arg>$cert_subject</arg>
      </validator>
  </action>
</actions>

