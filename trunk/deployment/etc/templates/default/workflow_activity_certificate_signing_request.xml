<actions>
  <!-- this action name has not to be human readable      -->
  <!-- because it is only used to initialize the workflow -->
  <action name="create_csr"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
         source="USER">
      <field name="cert_role"/>
      <field name="cert_profile"/>
      <field name="cert_subject_style"/>
      <field name="cert_subject"/>
      <field name="cert_subject_alt_name"/>
      <field name="cert_info"/>
      <field name="csr_type"/>
      <field name="spkac"/>
      <field name="pkcs10"/>
      <!-- do not use field with is_required                -->
      <!-- because this ignores the order of the validators -->
      <validator name="HasRequiredField">
        <arg>cert_role</arg>
      </validator>
      <validator name="CertRole">
        <arg>$cert_role</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_profile</arg>
      </validator>
      <validator name="CertProfile">
        <arg>$cert_profile</arg>
        <arg>$cert_profile_id</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_subject_style</arg>
        <arg>cert_subject</arg>
      </validator>
      <validator name="CertSubject">
        <arg>$cert_profile_id</arg>
        <arg>$cert_subject_style</arg>
        <arg>$cert_subject</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_subject_alt_name</arg>
      </validator>
      <validator name="CertSubjectAltName">
        <arg>$cert_subject_alt_name</arg>
      </validator>
      <validator name="HasRequiredField">
        <arg>cert_info</arg>
        <arg>csr_type</arg>
      </validator>
      <validator name="SPKAC">
        <arg>$csr_type</arg>
        <arg>$spkac</arg>
      </validator>
      <validator name="PKCS10">
        <arg>$csr_type</arg>
        <arg>$pkcs10</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_ROLE"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
         source="OPERATOR">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_role"/>
      <validator name="CertRole">
        <arg>$cert_role</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_PROFILE"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
         source="OPERATOR">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_profile"/>
      <validator name="CertProfile">
        <arg>$cert_profile</arg>
        <arg>$cert_profile_id</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_SUBJECT_STYLE"
	  class="Workflow::Action::Null">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_subject_style"/>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_SUBJECT"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
         source="OPERATOR">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_subject"/>
      <validator name="CertSubject">
        <arg>$cert_profile_id</arg>
        <arg>$cert_subject_style</arg>
        <arg>$cert_subject</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_SUBJECT_ALT_NAME"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::SetSource"
         source="OPERATOR">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_subject_alt_name"/>
      <validator name="CertSubjectAltName">
        <arg>$cert_subject_alt_name</arg>
      </validator>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CHANGE_CSR_INFO"
	  class="Workflow::Action::Null">
      <!-- do not use field with is_required="yes"          -->
      <!-- because this ignores the order of the validators -->
      <field name="cert_info"/>
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_APPROVE_CSR"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::Approve">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_EXPORT_CSR"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::Export"
          export_destination="0"
          export_state="INITIAL_IMPORT">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_PERSIST_CSR"
	  class="OpenXPKI::Server::Workflow::Activity::CSR::PersistRequest">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_CANCEL_CSR_APPROVAL"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::CancelApprovals">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_REJECT_CSR"
	  class="Workflow::Action::Null">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_SLEEP_FOR_CHILD"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::Sleep"
          time="5">
  </action>

  <action name="I18N_OPENXPKI_WF_ACTION_FORK_CERT_ISSUANCE_INSTANCE"
          class="OpenXPKI::Server::Workflow::Activity::Tools::ForkWorkflowInstance"
          workflow_type="I18N_OPENXPKI_WF_TYPE_CERTIFICATE_ISSUANCE">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_EXPORT_FINISHED_CSR"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::Export"
          export_destination="0"
          export_state="SUCCESS">
  </action>
  <action name="I18N_OPENXPKI_WF_ACTION_EXPORT_FAILED_CSR"
	  class="OpenXPKI::Server::Workflow::Activity::Tools::Export"
          export_destination="0"
          export_state="FAILURE">
  </action>
  <action name="null"
          class="Workflow::Action::Null">
  </action>
  <action name="generate_key"
          class="OpenXPKI::Server::Workflow::Activity::CSR::GenerateKey">
      <field name="_key_type"/>
      <field name="_password"/>
      <validator name="PasswordQuality">
        <arg>$_password</arg>
      </validator>
  </action>
  <action name="generate_pkcs10"
          class="OpenXPKI::Server::Workflow::Activity::CSR::GeneratePKCS10">
  </action>

</actions>

