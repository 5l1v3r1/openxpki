<conditions>

  <!-- always write the ACL conditions first followed by the normal conditions -->

  <!-- general CSR conditions -->

  <condition name="ACL::create_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="create_csr"/>
  </condition>
  <condition name="ACL::change_csr_role" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_role"/>
  </condition>
  <condition name="ACL::change_csr_profile" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_profile"/>
  </condition>
  <condition name="ACL::change_csr_subject_style" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_subject_style"/>
  </condition>
  <condition name="ACL::change_csr_subject" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_subject"/>
  </condition>
  <condition name="ACL::change_csr_subject_alt_name" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_subject_alt_name"/>
  </condition>
  <condition name="ACL::change_csr_info" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="change_csr_info"/>
  </condition>
  <condition name="ACL::approve_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="approve_csr"/>
  </condition>
  <condition name="ACL::cancel_csr_approval" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="cancel_csr_approval"/>
  </condition>
  <condition name="ACL::execute_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="execute_csr"/>
  </condition>
  <condition name="ACL::reject_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="reject_csr"/>
  </condition>

  <condition name="Condition::check_csr_approvals" class="OpenXPKI::Server::Workflow::Condition::Approved">
    <param name="role" value="RA Operator"/>
  </condition>

  <!-- if you use an online and an offline server then you need this for CSRs too -->

  <condition name="ACL::export_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="export_csr"/>
  </condition>
  <condition name="ACL::import_csr" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <param name="activity" value="export_csr"/>
  </condition>

  <condition name="Condition::server_0" class="OpenXPKI::Server::Workflow::Condition::Server">
    <param name="server_id" value="0"/>
  </condition>
  <condition name="Condition::check_csr_approvals_online" class="OpenXPKI::Server::Workflow::Condition::Approved">
    <param name="role" value="RA Operator"/>
  </condition>
  <condition name="Condition::check_csr_approvals_offline" class="OpenXPKI::Server::Workflow::Condition::Approved">
    <param name="role" value="CA Operator"/>
  </condition>

  <!-- check for system-instantiated workflow -->
  <condition name="ACL::system_internal" class="OpenXPKI::Server::Workflow::Condition::ACL">
    <!-- FIXME: insert proper arguments here -->
    <param name="caller" value="system"/>
  </condition>

  <!-- key online checks -->
  <condition name="CA::key_is_usable" class="OpenXPKI::Server::Workflow::Condition::Key">
    <!-- FIXME: insert proper arguments here -->
    <param name="key" value="ca"/>
    <param name="status" value="usable"/>
  </condition>

  <condition name="CA::key_is_not_usable" class="OpenXPKI::Server::Workflow::Condition::Key">
    <!-- FIXME: insert proper arguments here -->
    <param name="key" value="ca"/>
    <param name="status" value="unusable"/>
  </condition>

</conditions>

