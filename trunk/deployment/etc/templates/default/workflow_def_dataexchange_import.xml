<workflow>
  <type>I18N_OPENXPKI_WF_TYPE_DATAEXCHANGE_IMPORT</type>
  <description>I18N_OPENXPKI_WF_DESC_DATAEXCHANGE_IMPORT</description>
  <persister>OpenXPKI</persister>

  <state name="INITIAL">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_INITIAL</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_PREPARE_ENV" 
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ENV_READY">
      <condition name="ACL::dataexchange_import"/>
      <condition name="Condition::server_0"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ENV_READY" autorun="yes">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ENV_READY</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_IMPORT_READ_ARCHIVE"
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_READY">
      <condition name="ACL::dataexchange_import"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_READY" autorun="yes">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_READY</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_IMPORT_UNPACK_ARCHIVE"
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_UNPACKED">
      <condition name="ACL::dataexchange_import"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_UNPACKED" autorun="yes">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_ARCHIVE_UNPACKED</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_IMPORT_LOGS"
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_LOGS_DONE">
      <condition name="ACL::dataexchange_import"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_LOGS_DONE" autorun="yes">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_LOGS_DONE</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_IMPORT_WORKFLOW_INSTANCES"
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_COMPLETED">
      <condition name="ACL::dataexchange_import"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_COMPLETED" autorun="yes">
    <description>I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_COMPLETED</description>
    <action name="I18N_OPENXPKI_WF_ACTION_DATAEXCHANGE_CLEANUP"
	    resulting_state="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_SUCCEEDED">
      <condition name="ACL::dataexchange_import"/>
    </action>
  </state>

  <state name="I18N_OPENXPKI_WF_STATE_DATAEXCHANGE_IMPORT_SUCCEEDED"/>
</workflow>
