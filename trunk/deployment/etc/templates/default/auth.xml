<auth>
  <stack name="Anonymous">
    <description>I18N_OPENXPKI_CONFIG_AUTH_STACK_DESCRIPTION_ANONYMOUS</description>
    <handler>Anonymous</handler>
  </stack>
  <stack name="User">
    <description>I18N_OPENXPKI_CONFIG_AUTH_STACK_DESCRIPTION_USER</description>
    <handler>User Password</handler>
    <!-- <handler>LDAP</handler> -->
  </stack>
  <stack name="Operator">
    <description>I18N_OPENXPKI_CONFIG_AUTH_STACK_DESCRIPTION_OPERATOR</description>
    <!-- <handler>Signing</handler> -->
    <handler>Operator Password</handler>
  </stack>
  <stack name="External Dynamic">
    <description>I18N_OPENXPKI_CONFIG_AUTH_STACK_DESCRIPTION_EXTERNAL_DYNAMIC</description>
    <handler>External Dynamic Role</handler>
  </stack>
  <stack name="External Static">
    <description>I18N_OPENXPKI_CONFIG_AUTH_STACK_DESCRIPTION_EXTERNAL_STATIC</description>
    <handler>External Static Role</handler>
  </stack>
  <stack name="Certificate Challenge/Response">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_CERTIFICATE</description>
    <handler>Signature</handler>
  </stack>
  <handler name="Signature" type="X509">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_SIGNATURE</description>
    <trust_anchors>your,identifiers,here</trust_anchors>
    <pkcs7tool>testsceppkcs7tool1</pkcs7tool>
    <challenge_length>256</challenge_length>
  </handler>
  <handler name="Anonymous" type="Anonymous">
    <role></role>
  </handler>
  <handler name="User Password" type="Password">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_PASSWORD</description>
    <!-- howto generate sha1 passphrases?                     -->
    <!-- echo -n root | openssl sha1 -binary | openssl base64 -->
    <user>
      <name>John Doe</name>
      <algorithm>sha1</algorithm>
      <!-- this is Doe in sha1 -->
      <digest>yUetMg5m/GSZjoalXA2iEMjB2Bo=</digest>
      <role>User</role>
    </user>
  </handler>
  <handler name="Operator Password" type="Password">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_PASSWORD</description>
    <user>
      <name>root</name>
      <algorithm>sha1</algorithm>
      <!-- this is root in sha1 -->
      <digest>3Hbp8MAAbo+RngxRXGbbujmC94U</digest>
      <role>CA Operator</role>
    </user>
    <user>
      <name>raop</name>
      <algorithm>sha1</algorithm>
      <!-- this is raop in sha1 -->
      <digest>fXR0BfkSrEHvv1yCBBBIVBDw1qM</digest>
      <role>RA Operator</role>
    </user>
  </handler>
  <handler name="External Dynamic Role" type="External">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_EXTERNAL</description>
    <!-- please note this is only a test configuration !!! -->
    <!-- we use the passphrase to set the role             -->
    <!-- never do this in real environments !!!            -->
    <command>echo -n $PASSWD</command>
    <!-- if this field is empty then the role is determined dynamically -->
    <role></role>
    <pattern>x</pattern>
    <replacement>x</replacement>
    <env>
      <name>LOGIN</name>
      <value>__USER__</value>
    </env>
    <env>
      <name>PASSWD</name>
      <value>__PASSWD__</value>
    </env>
  </handler>
  <handler name="External Static Role" type="External">
    <description>I18N_OPENXPKI_CONFIG_AUTH_HANDLER_DESCRIPTION_EXTERNAL</description>
    <!-- please note this is only a test configuration !!! -->
    <!-- we use the passphrase to set the role             -->
    <!-- never do this in real environments !!!            -->
    <command>echo -n $PASSWD</command>
    <!-- if this field is empty then the role is determined dynamically -->
    <role>RA Operator</role>
    <pattern>x</pattern>
    <replacement>x</replacement>
    <env>
      <name>LOGIN</name>
      <value>__USER__</value>
    </env>
    <env>
      <name>PASSWD</name>
      <value>__PASSWD__</value>
    </env>
  </handler>
</auth>
