<%args>
    $workflow_id   => undef
    $workflow_type => undef
    $role          => undef
    $profile       => undef
    $subject_style => undef
    $keygen        => undef
    $pkcs10        => undef
    $subject       => undef
    $subject_alt_name => undef
    $info          => undef
    $CONFIG        => undef
    $keysettings   => undef,
</%args>
<& /service/open_form.mhtml &>

<& /lib/html/hidden.mhtml, 'name' => 'workflow_id',   'value' => $workflow_id &>
<& /lib/html/hidden.mhtml, 'name' => 'workflow_type', 'value' => $workflow_type &>
<& /lib/html/hidden.mhtml, 'name' => 'keygen',        'value' => $keygen &>
<& /lib/html/hidden.mhtml, 'name' => 'role',          'value' => $role &>
<& /lib/html/hidden.mhtml, 'name' => 'profile',       'value' => $profile &>
<& /lib/html/hidden.mhtml, 'name' => 'subject_style', 'value' => $subject_style &>
<& /lib/html/hidden.mhtml, 'name' => 'subject',       'value' => $subject &>
<& /lib/html/hidden.mhtml, 'name' => 'subject_alt_name', 'value' => $subject_alt_name &>
<& /lib/html/hidden.mhtml, 'name' => 'info',          'value' => $info &>
<h1><% i18nGettext ('I18N_OPENXPKI_CLIENT_HTML_MASON_CREATE_CSR_GET_KEYSETTINGS_TITLE') %></h1>
<p>
  <% i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_CREATE_CSR_GET_KEYSETTINGS_DESC') %>
</p>

<table>
  <tr>
    <td>
      <% i18nGettext ("I18N_OPENXPKI_CLIENT_HTML_MASON_CREATE_CSR_GET_KEYSETTINGS_CHOICE") %>
    </td>
    <td>
      <& '/lib/html/select.mhtml',
         'name'    => "keysettings",
         'values'  => [
            { 
              VALUE => 'RSA1024',
              LABEL => i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_RSA1024'),
            },
            { 
              VALUE => 'RSA2048',
              LABEL => i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_RSA2048'),
            },
            { 
              VALUE => 'ECDSA_PRIME192V1',
              LABEL => i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME192V1'),
            },
            { 
              VALUE => 'ECDSA_C2TNB191V1',
              LABEL => i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_C2TNB191V1'),
            },
            { 
              VALUE => 'ECDSA_PRIME239V1',
              LABEL => i18nGettext('I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME239V1'),
            },
        ] &>
    </td>
  </tr>
</table>

<& /service/send_form.mhtml &>
<& /service/close_form.mhtml &>

<dl>
  <dt><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_RSA1024") %></dt>
  <dd><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_RSA1024_DESC") %></dd>
  <dt><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_RSA2048") %></dt>
  <dd><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_RSA2048_DESC") %></dd>
  <dt><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME192V1") %></dt>
  <dd><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME192V1_DESC") %></dd>
  <dt><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_C2TNB191V1") %></dt>
  <dd><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_C2TNB191V1_DESC") %></dd>
  <dt><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME239V1") %></dt>
  <dd><% i18nGettext("I18N_OPENXPKI_CLIENT_HTML_MASON_ECDSA_PRIME239V1_DESC") %></dd>
</dl>
<& /service/create_csr/print_errors.mhtml, 'errors' => \@errors &>

<%init>
    my $PASSWORD_LENGTH = 16;
    my @errors = ();

    if ($keysettings)
    {
        return $keysettings;
    }
</%init>
